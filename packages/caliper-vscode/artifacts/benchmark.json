{
    "$schema": "http://json-schema.org/draft-06/schema#",
    "$ref": "#/definitions/benchmark",
    "definitions": {
        "benchmark": {
            "type": "object",
            "description": "Schema for benchmark configuration file. The benchmark configuration file is one of the required configuration files necessary to run a Caliper benchmark. In contrast to the runtime configurations, used for tweaking the internal behavior of Caliper, the benchmark configuration pertains only to the execution of the benchmark workload and collection of the results. URL: https://hyperledger.github.io/caliper/v0.5.0/bench-config/",
            "additionalProperties": false,
            "properties": {
                "test": {
                    "type": "object",
                    "additionalProperties": false,
                    "description": "The settings related to the benchmark workload all reside under the root test attribute, which has some general child attributes, and the important rounds attribute.",
                    "properties": {
                        "name": {
                            "description": "Short name of the benchmark to display in the report.",
                            "type": "string"
                        },
                        "description": {
                            "description": "Detailed description of the benchmark to display in the report.",
                            "type": "string"
                        },
                        "workers": {
                            "type": "object",
                            "description": "Object of worker-related configurations.",
                            "additionalProperties": false,
                            "properties": {
                                "number": {
                                    "description": "Specifies the number of worker processes to use for executing the workload.",
                                    "type": "integer"
                                },
                                "type": {
                                    "description": "Currently unused.",
                                    "type": "null"
                                }
                            },
                            "required": [
                                "number"
                            ],
                            "title": "Workers"
                        },
                        "rounds": {
                            "type": "array",
                            "description": "Array of objects, each describing the settings of a round.",
                            "items": {
                                "type": "object",
                                "additionalProperties": false,
                                "properties": {
                                    "label": {
                                        "description": "A short name of the rounds, usually corresponding to the types of submitted TXs.",
                                        "type": "string"
                                    },
                                    "txNumber": {
                                        "description": "The number of TXs Caliper should submit during the round.",
                                        "type": "integer"
                                    },
                                    "rateControl": {
                                        "type": "object",
                                        "description": "The object describing the rate controller to use for the round. For more, visit URL: https://hyperledger.github.io/caliper/v0.5.0/rate-controllers/",
                                        "additionalProperties": false,
                                        "properties": {
                                            "type": {
                                                "description": "Caliper permits the specification of custom rate controllers to enable a user to perform testing under a custom loading mechanism.",
                                                "type": "string"
                                            },
                                            "opts": {
                                                "type": "object",
                                                "additionalProperties": false,
                                                "properties": {
                                                    "tps": {
                                                        "description": "The rate at which transactions are cumulatively sent to the SUT by all workers",
                                                        "type": "integer"
                                                    },
                                                    "transactionLoad": {
                                                        "description": "The maximum transaction load on the SUT at which workers will pause sending further transactions",
                                                        "type": "integer"
                                                    },
                                                    "startingTps": {
                                                        "description": "The initial rate at which transactions are cumulatively sent to the SUT by all workers",
                                                        "type": "integer"
                                                    },
                                                    "step": {
                                                        "description": "The TPS increase for each interval. Note that on “back-off” this step size will automatically be reduced before re-attempting a TPS increase.",
                                                        "type": "integer"
                                                    },
                                                    "sampleInterval": {
                                                        "description": "the minimum time between steps to ensure settling of achieved TPS rates",
                                                        "type": "integer"
                                                    },
                                                    "includeFailed": {
                                                        "description": "Boolean flag to indicate if the achieved TPS analysis within the controller is to include failed transactions (default true)",
                                                        "type": "boolean"
                                                    },
                                                    "finishingTps": {
                                                        "description": "The rate at which transactions are cumulatively sent to the SUT by all workers at the end of the round",
                                                        "type": "integer"
                                                    }
                                                },
                                                "title": "Options"
                                            }
                                        },
                                        "required": [
                                            "opts",
                                            "type"
                                        ],
                                        "title": "RateControl"
                                    },
                                    "workload": {
                                        "type": "object",
                                        "description": "The object describing the workload module used for the round. URL for more details: https://hyperledger.github.io/caliper/v0.5.0/workload-module/",
                                        "additionalProperties": false,
                                        "properties": {
                                            "module": {
                                                "description": "The path to the benchmark workload module implementation that will construct the TXs to submit",
                                                "type": "string"
                                            },
                                            "arguments": {
                                                "description": "Arbitrary object that will be passed to the workload module as configuration.",
                                                "type": "null"
                                            }
                                        },
                                        "required": [
                                            "module"
                                        ],
                                        "title": "Workload"
                                    },
                                    "txDuration": {
                                        "type": "integer"
                                    }
                                },
                                "required": [
                                    "label",
                                    "rateControl",
                                    "workload"
                                ],
                                "title": "Round"
                            }
                        }
                    },
                    "required": [
                        "name",
                        "rounds",
                        "workers"
                    ],
                    "title": "Test"
                },
                "monitors": {
                    "type": "object",
                    "description": "The type of resource monitor to be used within a Caliper benchmark is declared in the benchmark configuration file through the specification one or more monitoring modules in an array under the label monitors.resource.",
                    "additionalProperties": false,
                    "properties": {
                        "transaction": {
                            "type": "array",
                            "items": {
                                "type": "object",
                                "additionalProperties": false,
                                "properties": {
                                    "module": {
                                        "type": "string"
                                    }
                                },
                                "required": [
                                    "module"
                                ],
                                "title": "Transaction"
                            }
                        },
                        "resource": {
                            "type": "array",
                            "description": "The type of resource monitor to be used within a Caliper benchmark is declared in the benchmark configuration file through the specification one or more monitoring modules in an array under the label monitors.resource. URl for more details: https://hyperledger.github.io/caliper/v0.5.0/caliper-monitors/",
                            "items": {
                                "type": "object",
                                "additionalProperties": false,
                                "properties": {
                                    "module": {
                                        "description": "Type of resource monitor used. One of the three: Process, Docker, Prometheus",
                                        "type": "string"
                                    },
                                    "options": {
                                        "type": "object",
                                        "description": "",
                                        "additionalProperties": false,
                                        "properties": {
                                            "interval": {
                                                "description": "monitor update interval in seconds",
                                                "type": "integer"
                                            },
                                            "processes": {
                                                "type": "object",
                                                "additionalProperties": false,
                                                "properties": {
                                                    "command": {
                                                        "description": "names the parent process to monitor",
                                                        "type": "string"

                                                    },
                                                    "arguments": {
                                                        "description": "filters on the parent process being monitored",
                                                        "type": "string"                                                        
                                                    },
                                                    "multiOutput": {
                                                        "description": "enables handling of the discovery of multiple processes and may be one of: avg or sum",
                                                        "type": "string"
                                                    }
                                                }
                                            },
                                            "cpuUsageNormalization": {
                                                "description": "An optional boolean that may be used to convert the cpu usage in a more covenient value (scaled to 100) by normalising for the number of cores of the host machine, default is set to false",
                                                "type": "boolean"
                                            },
                                            "containers": {
                                                "description": "An array of container names that may relate to local or remote docker containers to be monitored. If all local docker containers are to be monitored, this may be achieved by providing all as a name",
                                                "type": "array",
                                                "items": {
                                                    "type": "string"
                                                }
                                            },
                                            "url": {
                                                "description": "The Prometheus URL, used for direct queries",
                                                "type": "string",
                                                "format": "uri",
                                                "qt-uri-protocols": [
                                                    "http"
                                                ]
                                            },
                                            "metrics": {
                                                "type": "object",
                                                "description": "The queries to be run for inclusion within the Caliper report, comprised of to keys: include and queries",
                                                "additionalProperties": false,
                                                "properties": {
                                                    "include": {
                                                        "type": "array",
                                                        "description": "A series of blocks that describe the queries that are to be run at the end of each Caliper test.",
                                                        "items": {
                                                            "type": "string"
                                                        }
                                                    },
                                                    "queries": {
                                                        "type": "array",
                                                        "items": {
                                                            "type": "object",
                                                            "additionalProperties": false,
                                                            "properties": {
                                                                "name": {
                                                                    "description": "The metric name that the query relates to, used when building the report",
                                                                    "type": "string"
                                                                },
                                                                "query": {
                                                                    "description": "The query to be issued to the Prometheus server at the end of each test. Note that Caliper will add time bounding for the query so that only results pertaining to the test round are included",
                                                                    "type": "string"
                                                                },
                                                                "step": {
                                                                    "description": "The timing step size to use within the range query",
                                                                    "type": "integer"
                                                                },
                                                                "label": {
                                                                    "description": "A string to match on the returned query and used as a component identifier when populating the report",
                                                                    "type": "string"
                                                                },
                                                                "statistic": {
                                                                    "description": "If multiple values are returned, for instance if looking at a specific resource over a time range, the statistic will condense the values to a single result to enable reporting. Permitted options are: avg, max, min, sum",
                                                                    "type": "string"
                                                                }
                                                            },
                                                            "required": [
                                                                "label",
                                                                "name",
                                                                "query",
                                                                "statistic",
                                                                "step"
                                                            ],
                                                            "title": "Query"
                                                        },
                                                        "multiplier": {
                                                            "description": "An optional multiplier that may be used to convert exported metrics into a more convenient value (such as converting bytes to GB)",
                                                            "type": "number"
                                                        }
                                                    }
                                                },
                                                "required": [
                                                    "include",
                                                    "queries"
                                                ],
                                                "title": "Metrics"
                                            }
                                        },
                                        "required": [],
                                        "title": "Options"
                                    }
                                },
                                "required": [
                                    "module",
                                    "options"
                                ],
                                "title": "Resource"
                            }
                        }
                    },
                    "required": [
                        "resource",
                        "transaction"
                    ],
                    "title": "Monitors"
                }
            },
            "required": [
                "monitors",
                "test"
            ],
            "title": "benchmark"
        }
    }
}
